<html>

<head>
  <title>Raven Instant Messenger</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font: 13px Helvetica, Arial;
    }

    form {
      padding: 3px;
      position: fixed;
      bottom: 0;
      width: 100%;
    }

    form input {
      padding: 10px;
      width: 90%;
      margin-right: .5%;
    }
    .btn{
      width: 9%;
      padding: 10px;
    }
    #messages {
      list-style-type: none;
      font-size: 20px;
      margin: 0;
      padding: 0;
    }

    #messages li {
      padding: 5px 10px;
    }

    #messages li:nth-child(odd) {
      background: #eee;
    }
    .login-pane{
      text-align: center;
      margin-left: 38%;
      margin-top: 25%;
    }
  </style>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>

  <script>
  $(function () {
    var socket = io();
    $("#chat").hide();
		$("#name").focus();
    $('form').submit(function(){
        socket.emit('chat message', $('#m').val());
          $('#m').val('');
          return false;
    });
        socket.on('chat message', function(userID, msg){
          $('#messages').append($('<li>').text(userID+": "+msg));
        });

    		$("#join").click(function(){
    			var userID = $("#name").val();
    			if (userID != "") {
    				socket.emit("join", userID);
    				$("#login").detach();
    				$("#chat").show();
    				$("#msg").focus();
    				ready = true;
    			}
    		});
    		$("#name").keypress(function(e){
    			if(e.which == 13) {
    				var userID = $("#name").val();
    				if (userID != "") {
    					socket.emit("join", userID);
    					ready = true;
    					$("#login").detach();
    					$("#chat").show();
    					$("#msg").focus();
              $('#messages').append($('<li>').text(userID+" has joined the room"));
    				}
    			}
    		});
  });
  </script>
</head>

<body>
  <div class = "span5 offset2" id="login">
    <div class="row">
    <div class="login-pane">
      <img src="./images/raven-64.png">
      <h3 style="margin-bottom: 3.3vh;">Raven Instant Messenger</h3>
      <label>Enter a User Name:</label>
      <input style="margin-bottom: 5.3vh;"type="text" class="input-small" id="name">
      <br>
      <input type="button" class="btn btn-primary" name="join" id="join" value="Join" style="width:35%;">
    </div>
  </div>
  </div>
  <ul id="messages"></ul>
  <div id ="chat">
  <form action="">
      <div class="input-group">
        <input id="m" autocomplete="off" type="text" class="form-control">
        <button class="btn btn-success" type="button">Send</button>
      </div>
  </form>
</div>
</body>

</html>
